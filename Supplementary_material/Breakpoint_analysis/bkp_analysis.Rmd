---
title: "Untitled"
author: "Qian Feng"
date: "11/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#######################################################################
# Section 1 ; rec proportions
**Step 1**: Load libraries

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
library(data.table)
library(stringr)
library(ggplot2)
library(ggpubr)
```

**Step 2**: Read results into R
```{r}
simulation_30_70_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_30-70_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
simulation_40_60_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_40-60_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
simulation_50_50_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_50-50_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
simulation_60_40_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_60-40_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
simulation_70_30_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_70-30_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(simulation_30_70_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(simulation_40_60_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(simulation_50_50_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(simulation_60_40_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(simulation_70_30_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```





**Step 3**: organize the dataframe and draw the violin plot
```{r}
bkp_data <- list()
bkp_data[[1]] = data.frame(rec = rep(30,length(simulation_30_70_output[,2])), bkp= simulation_30_70_output[,7], group = c(rep("jump_once",length(simulation_30_70_output[,2]))))
bkp_data[[2]] = data.frame(rec = rep(40,length(simulation_40_60_output[,2])), bkp= simulation_40_60_output[,7], group = c(rep("jump_once",length(simulation_40_60_output[,2]))))
bkp_data[[3]] = data.frame(rec = rep(50,length(simulation_50_50_output[,2])), bkp= simulation_50_50_output[,7], group = c(rep("jump_once",length(simulation_50_50_output[,2]))))
bkp_data[[4]] = data.frame(rec = rep(60,length(simulation_60_40_output[,2])), bkp= simulation_60_40_output[,7], group = c(rep("jump_once",length(simulation_60_40_output[,2]))))
bkp_data[[5]] = data.frame(rec = rep(70,length(simulation_70_30_output[,2])), bkp= simulation_70_30_output[,7], group = c(rep("jump_once",length(simulation_70_30_output[,2]))))
df=do.call(rbind, bkp_data)
df$rec<- as.factor(df$rec)
#head(df)
```

##draw a vioplots
```{r}
df_once <- df[df$group=="jump_once",]
p<-ggplot(df_once, aes(x=rec, y=bkp)) +
  geom_violin()
p
```



#hist
```{r}
par(mfrow=c(1,5))
hist(simulation_30_70_output$bkp_error,breaks=50)
hist(simulation_40_60_output$bkp_error,breaks=50)
hist(simulation_50_50_output$bkp_error,breaks=50)
hist(simulation_60_40_output$bkp_error,breaks=50)
hist(simulation_70_30_output$bkp_error,breaks=50)
```

# hist for comparing different replicates at only one setting
## take the example of jump once + 30% rec proportion, conclusion is different replicates show different distributions, but they all have biggest frequency at position 0.
```{r eval=FALSE, warning=TRUE, include=FALSE}
par(mfrow=c(2,5))
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==0),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==1),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==2),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==3),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==4),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==5),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==6),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==7),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==8),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==9),]$bkp_error)
```


```{r eval=FALSE, include=FALSE}
summary(simulation_30_70_output$bkp_error)
summary(simulation_40_60_output$bkp_error)
summary(simulation_50_50_output$bkp_error)
summary(simulation_60_40_output$bkp_error)
summary(simulation_70_30_output$bkp_error)
```

## draw the actual_bkp vs identified_bkp plots
```{r}
par(mfrow=c(1,5))
plot(simulation_30_70_output$identified_bkp,simulation_30_70_output$actual_bkp)
abline(0,1,col="red")
plot(simulation_40_60_output$identified_bkp,simulation_40_60_output$actual_bkp)
abline(0,1,col="red")
plot(simulation_50_50_output$identified_bkp,simulation_50_50_output$actual_bkp)
abline(0,1,col="red")
plot(simulation_60_40_output$identified_bkp,simulation_60_40_output$actual_bkp)
abline(0,1,col="red")
plot(simulation_70_30_output$identified_bkp,simulation_70_30_output$actual_bkp)
abline(0,1,col="red")
```


#######################################################################


```{r}

par(mfrow=c(1,2))
plot(simulation_50_50_output$identified_bkp,simulation_50_50_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint")
abline(0,1,col="red")
hist(abs(simulation_50_50_output$bkp_error),xlab="Absolute difference between identified and actual breakpoint",breaks=seq(0,200,5),col="black",border="white",main="")
```




#######################################################################
# Section 2 : mutations

##read data into R
```{r}
mutation_0.2_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_0.2_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_0.4_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_0.4_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_0.6_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_0.6_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_0.8_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_0.8_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_2_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_2_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_3_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_3_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_4_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_4_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_5_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_5_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(mutation_0.2_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_0.4_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_0.6_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_0.8_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_2_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_3_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_4_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_5_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```

##
```{r}
par(mfrow=c(2,4))
plot(mutation_0.2_output$identified_bkp,mutation_0.2_output$actual_bkp)
abline(0,1,col="red")
plot(mutation_0.4_output$identified_bkp,mutation_0.4_output$actual_bkp)
abline(0,1,col="red")
plot(mutation_0.6_output$identified_bkp,mutation_0.6_output$actual_bkp)
abline(0,1,col="red")
plot(mutation_0.8_output$identified_bkp,mutation_0.8_output$actual_bkp)
abline(0,1,col="red")
plot(mutation_2_output$identified_bkp,mutation_2_output$actual_bkp)
abline(0,1,col="red")
plot(mutation_3_output$identified_bkp,mutation_3_output$actual_bkp)
abline(0,1,col="red")
plot(mutation_4_output$identified_bkp,mutation_4_output$actual_bkp)
abline(0,1,col="red")
plot(mutation_5_output$identified_bkp,mutation_5_output$actual_bkp)
abline(0,1,col="red")
```

#######################################################################

#######################################################################
# Section 3 : indels

```{r}
indels_0_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_0.01_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0.01_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_0.02_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0.02_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_0.03_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0.03_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_0.04_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0.04_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_q_0.1_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_q_0.1_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_q_0.3_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_q_0.3_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_q_0.4_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_q_0.4_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_q_0.5_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_q_0.5_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(indels_0_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_0.01_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_0.02_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_0.03_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_0.04_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_q_0.1_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_q_0.3_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_q_0.4_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_q_0.5_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```


##
```{r}
par(mfrow=c(1,5))
plot(indels_0_output$identified_bkp,indels_0_output$actual_bkp)
abline(0,1,col="red")
plot(indels_0.01_output$identified_bkp,indels_0.01_output$actual_bkp)
abline(0,1,col="red")
plot(indels_0.02_output$identified_bkp,indels_0.02_output$actual_bkp)
abline(0,1,col="red")
plot(indels_0.03_output$identified_bkp,indels_0.03_output$actual_bkp)
abline(0,1,col="red")
plot(indels_0.04_output$identified_bkp,indels_0.04_output$actual_bkp)
abline(0,1,col="red")

```


```{r}
par(mfrow=c(1,4))
plot(indels_q_0.1_output$identified_bkp,indels_q_0.1_output$actual_bkp)
abline(0,1,col="red")
plot(indels_q_0.3_output$identified_bkp,indels_q_0.3_output$actual_bkp)
abline(0,1,col="red")
plot(indels_q_0.4_output$identified_bkp,indels_q_0.4_output$actual_bkp)
abline(0,1,col="red")
plot(indels_q_0.5_output$identified_bkp,indels_q_0.5_output$actual_bkp)
abline(0,1,col="red")
```


#######################################################################

#######################################################################
# Section 4 : length
```{r}
len_100_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_seq_length/results_all/simulation_50-50/jump_once_only/length_100_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
len_150_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_seq_length/results_all/simulation_50-50/jump_once_only/length_150_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
len_250_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_seq_length/results_all/simulation_50-50/jump_once_only/length_250_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
len_300_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_seq_length/results_all/simulation_50-50/jump_once_only/length_300_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)

colnames(len_100_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(len_150_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(len_250_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(len_300_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```


```{r}
par(mfrow=c(1,4))
plot(len_100_output$identified_bkp,len_100_output$actual_bkp)
abline(0,1,col="red")
plot(len_150_output$identified_bkp,len_150_output$actual_bkp)
abline(0,1,col="red")
plot(len_250_output$identified_bkp,len_250_output$actual_bkp)
abline(0,1,col="red")
plot(len_300_output$identified_bkp,len_300_output$actual_bkp)
abline(0,1,col="red")
```


```{r}
cor(len_100_output$identified_bkp,len_100_output$actual_bkp)
cor(len_150_output$identified_bkp,len_150_output$actual_bkp)
cor(simulation_50_50_output$identified_bkp,simulation_50_50_output$actual_bkp)
cor(len_250_output$identified_bkp,len_250_output$actual_bkp)
cor(len_300_output$identified_bkp,len_300_output$actual_bkp)
```


#######################################################################

#######################################################################
# Section 5 : AA models
```{r}
DAYHOFF_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/DAYHOFF_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
JTT_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/JTT_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
LG_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/LG_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
AB_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/AB_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
MTMAM_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/MTMAM_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(DAYHOFF_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(JTT_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(LG_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(AB_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(MTMAM_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```

##
```{r}
par(mfrow=c(1,5))
plot(DAYHOFF_output$identified_bkp,DAYHOFF_output$actual_bkp)
abline(0,1,col="red")
plot(JTT_output$identified_bkp,JTT_output$actual_bkp)
abline(0,1,col="red")
plot(LG_output$identified_bkp,LG_output$actual_bkp)
abline(0,1,col="red")
plot(AB_output$identified_bkp,AB_output$actual_bkp)
abline(0,1,col="red")
plot(MTMAM_output$identified_bkp,MTMAM_output$actual_bkp)
abline(0,1,col="red")
```

