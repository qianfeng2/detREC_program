---
title: "Supporting Figures about Breakpoints Accuracy"
author: "Qian Feng"
date: "Last compiled on `r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8,
                      echo=TRUE, warning=FALSE, message=FALSE,
                      tidy=TRUE)
```
#######################################################################

There are six biologically realistic senarios in the simulation datasets,  
1. different recombination proportions  
2. different mutation rates  
3. different indel rates  
4. different indel sizes  
5. different sequence lengths  
6. different amino acid models
7. different dataset size (the number of sequences per replicate).

Breakpoints' accuracy evaluation for each scenario is summarized by two plots, one is scatter plot between identified breakpoint and real breakpoint positions, second is the histogram for the absolute values of the difference between identified breakpoint and real breakpoint positions. So there are two plots for each case. Manuscript only offers related results when recombination proportion is equal to 50\%. This file provides all the supplementary figures for the manuscript in terms of breakpoints' accuracy evaluation section.

Therefore, all the folowing figures present scatter plot and histogram for each scenario. 



```{r include=FALSE}
library(data.table)
library(stringr)
library(ggplot2)
library(ggpubr)
```

#### Section 1: Different recombination proportions

```{r echo=FALSE}
simulation_30_70_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_30-70_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
simulation_40_60_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_40-60_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
simulation_50_50_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_50-50_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
simulation_60_40_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_60-40_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
simulation_70_30_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results/jump_once_only/simulation_70-30_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(simulation_30_70_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(simulation_40_60_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(simulation_50_50_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(simulation_60_40_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(simulation_70_30_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```






```{r eval=FALSE, include=FALSE}
#violin plots are not that informative, so we decide to remove them.
bkp_data <- list()
bkp_data[[1]] = data.frame(rec = rep(30,length(simulation_30_70_output[,2])), bkp= simulation_30_70_output[,7], group = c(rep("jump_once",length(simulation_30_70_output[,2]))))
bkp_data[[2]] = data.frame(rec = rep(40,length(simulation_40_60_output[,2])), bkp= simulation_40_60_output[,7], group = c(rep("jump_once",length(simulation_40_60_output[,2]))))
bkp_data[[3]] = data.frame(rec = rep(50,length(simulation_50_50_output[,2])), bkp= simulation_50_50_output[,7], group = c(rep("jump_once",length(simulation_50_50_output[,2]))))
bkp_data[[4]] = data.frame(rec = rep(60,length(simulation_60_40_output[,2])), bkp= simulation_60_40_output[,7], group = c(rep("jump_once",length(simulation_60_40_output[,2]))))
bkp_data[[5]] = data.frame(rec = rep(70,length(simulation_70_30_output[,2])), bkp= simulation_70_30_output[,7], group = c(rep("jump_once",length(simulation_70_30_output[,2]))))
df=do.call(rbind, bkp_data)
df$rec<- as.factor(df$rec)
df_once <- df[df$group=="jump_once",]
p<-ggplot(df_once, aes(x=rec, y=bkp)) +
  geom_violin()+scale_y_continuous(breaks=seq(-20,20,by=5),limits=c(-20,20))
p
```





##### histograms
```{r echo=FALSE}
par(mfrow=c(1,4))
hist(abs(simulation_30_70_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="rec=30")
hist(abs(simulation_40_60_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="rec=40")
hist(abs(simulation_60_40_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="rec=60")
hist(abs(simulation_70_30_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="rec=70")
```


```{r eval=FALSE, warning=TRUE, include=FALSE}
# hist for comparing different replicates at only one setting
## take the example of jump once + 30% rec proportion, conclusion is different replicates show different distributions, but they all have biggest frequency at position 0.
par(mfrow=c(2,5))
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==0),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==1),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==2),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==3),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==4),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==5),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==6),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==7),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==8),]$bkp_error)
hist(simulation_30_70_output[which(simulation_30_70_output$replicate==9),]$bkp_error)

summary(simulation_30_70_output$bkp_error)
summary(simulation_40_60_output$bkp_error)
summary(simulation_50_50_output$bkp_error)
summary(simulation_60_40_output$bkp_error)
summary(simulation_70_30_output$bkp_error)
```



##### scatter plots for the actual_bkp vs identified_bkp
```{r echo=FALSE}
par(mfrow=c(1,4))
plot(simulation_30_70_output$identified_bkp,simulation_30_70_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="rec=30")
abline(0,1,col="red")
plot(simulation_40_60_output$identified_bkp,simulation_40_60_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="rec=40")
abline(0,1,col="red")
#plot(simulation_50_50_output$identified_bkp,simulation_50_50_output$actual_bkp)
abline(0,1,col="red")
plot(simulation_60_40_output$identified_bkp,simulation_60_40_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="rec=60")
abline(0,1,col="red")
plot(simulation_70_30_output$identified_bkp,simulation_70_30_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="rec=70")
abline(0,1,col="red")
```




```{r eval=FALSE, include=FALSE}
# This chunk generat the figure for manuscript when rec proportion=50%
#pdf(file="/Users/fengqian/Downloads/cabios-template/figures/bkp.pdf", height=4, width=8)
par(mfrow=c(1,2))
plot(simulation_50_50_output$identified_bkp,simulation_50_50_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint")
abline(0,1,col="red")
hist(abs(simulation_50_50_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="")
#dev.off()
```



\newpage
#### Section 2 : Different mutation rates

```{r include=FALSE}
mutation_0.2_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_0.2_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_0.4_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_0.4_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_0.6_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_0.6_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_0.8_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_0.8_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_2_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_2_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_3_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_3_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_4_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_4_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
mutation_5_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_mutation/results_all/simulation_50-50/jump_once_only/mutation_5_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(mutation_0.2_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_0.4_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_0.6_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_0.8_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_2_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_3_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_4_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(mutation_5_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```


##### histograms
```{r echo=FALSE}
par(mfrow=c(1,4))
hist(abs(mutation_0.2_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="bm=0.2")
hist(abs(mutation_0.4_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="bm=0.4")
hist(abs(mutation_0.6_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="bm=0.6")
hist(abs(mutation_0.8_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="bm=0.8")
hist(abs(mutation_2_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="bm=2")
hist(abs(mutation_3_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="bm=3")
hist(abs(mutation_4_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="bm=4")
hist(abs(mutation_5_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="bm=5")
```

##### scatter plots for the actual_bkp vs identified_bkp
```{r echo=FALSE}
par(mfrow=c(2,4))
plot(mutation_0.2_output$identified_bkp,mutation_0.2_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="bm=0.2")
abline(0,1,col="red")
plot(mutation_0.4_output$identified_bkp,mutation_0.4_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="bm=0.4")
abline(0,1,col="red")
plot(mutation_0.6_output$identified_bkp,mutation_0.6_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="bm=0.6")
abline(0,1,col="red")
plot(mutation_0.8_output$identified_bkp,mutation_0.8_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="bm=0.8")
abline(0,1,col="red")
plot(mutation_2_output$identified_bkp,mutation_2_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="bm=2")
abline(0,1,col="red")
plot(mutation_3_output$identified_bkp,mutation_3_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="bm=3")
abline(0,1,col="red")
plot(mutation_4_output$identified_bkp,mutation_4_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="bm=4")
abline(0,1,col="red")
plot(mutation_5_output$identified_bkp,mutation_5_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="bm=5")
abline(0,1,col="red")
```








\newpage
#### Section 3: Different indel rates

```{r echo=FALSE}
indels_0_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_0.01_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0.01_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_0.02_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0.02_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_0.03_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0.03_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_0.04_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_0.04_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_q_0.1_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_q_0.1_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_q_0.3_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_q_0.3_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_q_0.4_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_q_0.4_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
indels_q_0.5_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_indels/results_all/simulation_50-50/jump_once_only/indels_q_0.5_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(indels_0_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_0.01_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_0.02_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_0.03_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_0.04_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_q_0.1_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_q_0.3_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_q_0.4_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(indels_q_0.5_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```

##### histograms
```{r echo=FALSE}
par(mfrow=c(1,5))
hist(abs(indels_0_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="r=0")
hist(abs(indels_0.01_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="r=0.01")
hist(abs(indels_0.02_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="r=0.02")
hist(abs(indels_0.03_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="r=0.03")
hist(abs(indels_0.04_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,250,5),col="black",border="white",main="r=0.04")
```

##### scatter plots for the actual_bkp vs identified_bkp
```{r echo=FALSE}
par(mfrow=c(1,5))
plot(indels_0_output$identified_bkp,indels_0_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="r=0")
abline(0,1,col="red")
plot(indels_0.01_output$identified_bkp,indels_0.01_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="r=0.01")
abline(0,1,col="red")
plot(indels_0.02_output$identified_bkp,indels_0.02_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="r=0.02")
abline(0,1,col="red")
plot(indels_0.03_output$identified_bkp,indels_0.03_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="r=0.03")
abline(0,1,col="red")
plot(indels_0.04_output$identified_bkp,indels_0.04_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="r=0.04")
abline(0,1,col="red")
```

\newpage
#### Section 4: Different indel sizes
##### histograms
```{r echo=FALSE}
par(mfrow=c(1,4))
hist(abs(indels_q_0.1_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,300,5),col="black",border="white",main="q=0.1")
hist(abs(indels_q_0.3_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="q=0.3")
hist(abs(indels_q_0.4_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="q=0.4")
hist(abs(indels_q_0.5_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="q=0.5")
```

##### scatter plots for the actual_bkp vs identified_bkp
```{r echo=FALSE}
par(mfrow=c(1,4))
plot(indels_q_0.1_output$identified_bkp,indels_q_0.1_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="q=0.1")
abline(0,1,col="red")
plot(indels_q_0.3_output$identified_bkp,indels_q_0.3_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="q=0.3")
abline(0,1,col="red")
plot(indels_q_0.4_output$identified_bkp,indels_q_0.4_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="q=0.4")
abline(0,1,col="red")
plot(indels_q_0.5_output$identified_bkp,indels_q_0.5_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="q=0.5")
abline(0,1,col="red")
```


\newpage
#### Section 5 : Different sequence lengths
```{r echo=FALSE}
len_100_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_seq_length/results_all/simulation_50-50/jump_once_only/length_100_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
len_150_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_seq_length/results_all/simulation_50-50/jump_once_only/length_150_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
len_250_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_seq_length/results_all/simulation_50-50/jump_once_only/length_250_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
len_300_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_seq_length/results_all/simulation_50-50/jump_once_only/length_300_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)

colnames(len_100_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(len_150_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(len_250_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(len_300_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```

##### histograms
```{r echo=FALSE}
par(mfrow=c(1,4))
hist(abs(len_100_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="len=100")
hist(abs(len_150_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="len=150")
hist(abs(len_250_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,250,5),col="black",border="white",main="len=250")
hist(abs(len_300_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,300,5),col="black",border="white",main="len=300")
```

##### scatter plots for the actual_bkp vs identified_bkp
```{r echo=FALSE}
par(mfrow=c(1,4))
plot(len_100_output$identified_bkp,len_100_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="len=100")
abline(0,1,col="red")
plot(len_150_output$identified_bkp,len_150_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="len=150")
abline(0,1,col="red")
plot(len_250_output$identified_bkp,len_250_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="len=250")
abline(0,1,col="red")
plot(len_300_output$identified_bkp,len_300_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="len=300")
abline(0,1,col="red")
```


```{r eval=FALSE, include=FALSE}
cor(len_100_output$identified_bkp,len_100_output$actual_bkp)
cor(len_150_output$identified_bkp,len_150_output$actual_bkp)
cor(simulation_50_50_output$identified_bkp,simulation_50_50_output$actual_bkp)
cor(len_250_output$identified_bkp,len_250_output$actual_bkp)
cor(len_300_output$identified_bkp,len_300_output$actual_bkp)
```


\newpage
#### Section 6 : Different AA models
```{r echo=FALSE}
DAYHOFF_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/DAYHOFF_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
JTT_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/JTT_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
LG_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/LG_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
AB_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/AB_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
MTMAM_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_AA_models/results_all/simulation_50-50/jump_once_only/MTMAM_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(DAYHOFF_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(JTT_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(LG_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(AB_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(MTMAM_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```

##### histograms
```{r echo=FALSE}
par(mfrow=c(1,5))
hist(abs(DAYHOFF_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="DAYHOFF")
hist(abs(JTT_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="JTT")
hist(abs(LG_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="LG")
hist(abs(AB_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="AB")
hist(abs(MTMAM_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="MTMAM")
```

##### scatter plots for the actual_bkp vs identified_bkp
```{r echo=FALSE}
par(mfrow=c(1,5))
plot(DAYHOFF_output$identified_bkp,DAYHOFF_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="DAYHOFF")
abline(0,1,col="red")
plot(JTT_output$identified_bkp,JTT_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="JTT")
abline(0,1,col="red")
plot(LG_output$identified_bkp,LG_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="LG")
abline(0,1,col="red")
plot(AB_output$identified_bkp,AB_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="AB")
abline(0,1,col="red")
plot(MTMAM_output$identified_bkp,MTMAM_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="MTMAM")
abline(0,1,col="red")
```



\newpage
#### Section 7 : Different dataset size
```{r echo=FALSE}
size50_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_dataset_size/results_all/simulation_50-50/jump_once_only/size_50_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
size100_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_dataset_size/results_all/simulation_50-50/jump_once_only/size_100_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
size150_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_dataset_size/results_all/simulation_50-50/jump_once_only/size_150_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
size200_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_dataset_size/results_all/simulation_50-50/jump_once_only/size_200_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
size250_output <- fread("/Users/fengqian/Downloads/UniMelb_shared-master/algorithm_simulation/protein/snake_pipeline/final_results_dataset_size/results_all/simulation_50-50/jump_once_only/size_250_output_error.csv"
                            , header=FALSE
                            , data.table = FALSE)
colnames(size50_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(size100_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(size150_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(size200_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
colnames(size250_output ) <- c("chunk","target","db1","db2",	"rec","sv",	"bkp_error","identified_bkp",	"actual_bkp","replicate")
```

##### histograms
```{r echo=FALSE}
#pdf(file="bkp_error.pdf", height=6, width=12)
par(mfrow=c(1,5))
hist(abs(size50_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="size 50")
hist(abs(size100_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="size 100")
hist(abs(size150_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="size 150")
hist(abs(size200_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="size200")
hist(abs(size250_output$bkp_error),xlab="Absolute value of difference",breaks=seq(0,200,5),col="black",border="white",main="size250")
#dev.off()
```

##### scatter plots for the actual_bkp vs identified_bkp
```{r echo=FALSE}
#pdf(file="bkp_error_2.pdf", height=6, width=12)
par(mfrow=c(1,5))
plot(size50_output$identified_bkp,size50_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="size 50")
abline(0,1,col="red")
plot(size100_output$identified_bkp,size100_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="size 100")
abline(0,1,col="red")
plot(size150_output$identified_bkp,size150_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="size 150")
abline(0,1,col="red")
plot(size200_output$identified_bkp,size200_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="size 200")
abline(0,1,col="red")
plot(size250_output$identified_bkp,size250_output$actual_bkp,pch=20,xlab="Identified breakpoint",ylab="Actual breakpoint",main="size 250")
abline(0,1,col="red")
#dev.off()
```

```{r eval=FALSE, include=FALSE}
cor(size50_output$identified_bkp,size50_output$actual_bkp)
cor(size100_output$identified_bkp,size100_output$actual_bkp)
cor(size150_output$identified_bkp,size150_output$actual_bkp)
cor(size200_output$identified_bkp,size200_output$actual_bkp)
cor(size250_output$identified_bkp,size250_output$actual_bkp)
```




```{r}
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
Des_stat <- function(v){
  temp=c(getmode(v),median(v),sum(v-median(v))/length(v),mean(v),sd(v))
  return(temp)
}
Des_stat(simulation_30_70_output$bkp_error)
Des_stat(simulation_40_60_output$bkp_error)
Des_stat(simulation_50_50_output$bkp_error)
Des_stat(simulation_60_40_output$bkp_error)
Des_stat(simulation_70_30_output$bkp_error)
cat("******************* \n")
Des_stat(mutation_0.2_output$bkp_error)
Des_stat(mutation_0.4_output$bkp_error)
Des_stat(mutation_0.6_output$bkp_error)
Des_stat(mutation_0.8_output$bkp_error)
Des_stat(mutation_2_output$bkp_error)
Des_stat(mutation_3_output$bkp_error)
Des_stat(mutation_4_output$bkp_error)
Des_stat(mutation_5_output$bkp_error)
cat("******************* \n")
Des_stat(indels_0.01_output$bkp_error)
Des_stat(indels_0.02_output$bkp_error)
Des_stat(indels_0.03_output$bkp_error)
Des_stat(indels_0.04_output$bkp_error)
Des_stat(indels_q_0.1_output$bkp_error)
Des_stat(indels_q_0.3_output$bkp_error)
Des_stat(indels_q_0.4_output$bkp_error)
Des_stat(indels_q_0.5_output$bkp_error)
cat("******************* \n")
Des_stat(len_100_output$bkp_error)
Des_stat(len_150_output$bkp_error)
Des_stat(len_250_output$bkp_error)
Des_stat(len_300_output$bkp_error)
cat("******************* \n")
Des_stat(AB_output$bkp_error)
Des_stat(DAYHOFF_output$bkp_error)
Des_stat(JTT_output$bkp_error)
Des_stat(LG_output$bkp_error)
Des_stat(MTMAM_output$bkp_error)
cat("******************* \n")
Des_stat(size50_output$bkp_error)
Des_stat(size100_output$bkp_error)
Des_stat(size150_output$bkp_error)
Des_stat(size200_output$bkp_error)
Des_stat(size250_output$bkp_error)
cat("******************* \n")
cat("******************* \n")
cat("******************* \n")
sum(abs(simulation_30_70_output$bkp_error)<=10)/length(simulation_30_70_output$bkp_error)
sum(abs(simulation_40_60_output$bkp_error)<=10)/length(simulation_40_60_output$bkp_error)
sum(abs(simulation_50_50_output$bkp_error)<=10)/length(simulation_50_50_output$bkp_error)
sum(abs(simulation_60_40_output$bkp_error)<=10)/length(simulation_60_40_output$bkp_error)
sum(abs(simulation_70_30_output$bkp_error)<=10)/length(simulation_70_30_output$bkp_error)
sum(abs(len_100_output$bkp_error)<=5)/length(len_100_output$bkp_error)
sum(abs(len_150_output$bkp_error)<=7.5)/length(len_150_output$bkp_error)
sum(abs(len_250_output$bkp_error)<=12.5)/length(len_250_output$bkp_error)
sum(abs(len_300_output$bkp_error)<=15)/length(len_300_output$bkp_error)
sum(abs(size50_output$bkp_error)<=10)/length(size50_output$bkp_error)
sum(abs(size100_output$bkp_error)<=10)/length(size100_output$bkp_error)
sum(abs(size150_output$bkp_error)<=10)/length(size150_output$bkp_error)
sum(abs(size250_output$bkp_error)<=10)/length(size250_output$bkp_error)
sum(abs(indels_0.01_output$bkp_error)<=10)/length(indels_0.01_output$bkp_error)
sum(abs(indels_0.02_output$bkp_error)<=10)/length(indels_0.02_output$bkp_error)
sum(abs(indels_0.03_output$bkp_error)<=10)/length(indels_0.03_output$bkp_error)
sum(abs(indels_0.04_output$bkp_error)<=10)/length(indels_0.04_output$bkp_error)
sum(abs(indels_q_0.1_output$bkp_error)<=10)/length(indels_q_0.1_output$bkp_error)
sum(abs(indels_q_0.3_output$bkp_error)<=10)/length(indels_q_0.3_output$bkp_error)
sum(abs(indels_q_0.4_output$bkp_error)<=10)/length(indels_q_0.4_output$bkp_error)
sum(abs(indels_q_0.5_output$bkp_error)<=10)/length(indels_q_0.5_output$bkp_error)

sum(abs(AB_output$bkp_error)<=10)/length(AB_output$bkp_error)
sum(abs(DAYHOFF_output$bkp_error)<=10)/length(DAYHOFF_output$bkp_error)
sum(abs(JTT_output$bkp_error)<=10)/length(JTT_output$bkp_error)
sum(abs(LG_output$bkp_error)<=10)/length(LG_output$bkp_error)
sum(abs(MTMAM_output$bkp_error)<=10)/length(MTMAM_output$bkp_error)
```

```{r}
library(lattice)
#rec_pro <- data.frame(bkp=c(simulation_30_70_output$bkp_error,simulation_40_60_output$bkp_error,simulation_50_50_output$bkp_error,simulation_60_40_output$bkp_error,simulation_70_30_output$bkp_error),name=c(rep(30,length(simulation_30_70_output$bkp_error)),rep(40,length(simulation_40_60_output$bkp_error)),rep(50,length(simulation_50_50_output$bkp_error)),rep(60,length(simulation_60_40_output$bkp_error)),rep(70,length(simulation_70_30_output$bkp_error))))



rec_pro_50 <- data.frame(bkp=simulation_50_50_output$bkp_error,name=rep("Default simulation dataset",length(simulation_50_50_output$bkp_error)))

pdf(file="/Users/fengqian/Downloads/rec_paper_version3/figures/bkp.pdf",height=8, width=12)
#ggplot(rec_pro_50, aes(x=bkp)) + geom_histogram(aes(y=..density..),colour="black", fill="gray")+scale_x_continuous(breaks=seq(-50,50,by=5),limits=c(-30,30))+xlab("Difference of breakpoint locations")+ylab("Density")+theme(axis.title.x = element_text(size = 20), axis.title.y = element_text(size = 20))

rec_pro_50=data.frame(bkp=simulation_50_50_output$bkp_error)
p<-ggplot(rec_pro_50, aes(x=bkp)) + 
  geom_histogram(color=I("black"), fill=I("black"),alpha=I(.4))+xlab("Breakpoint distance difference")+ylab( "Occurrence")+ theme_bw()+ theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())+theme(axis.text.x = element_text(size=10),axis.text.y = element_text(size=10),axis.title.y = element_text(size = 14),axis.title.x = element_text(size = 14))+scale_x_continuous(breaks=seq(-200,200,by=5),limits = c(-30,30))+scale_y_continuous(expand = c(0, 0),limits = c(0,3500))
p
#+geom_density(adjust = 5)
#+scale_y_continuous(expand = c(0, 0),limits = c(0,3000))+scale_x_continuous(expand = c(-0.01, 0))
,bins=30
dev.off()

pdf(file="/Users/fengqian/Downloads/supplementary_files_QianFeng/S4_bkp_density.pdf",onefile=F)
ggplot(simulation_50_50_output, aes(x = identified_bkp, y = actual_bkp) ) +geom_bin2d()+xlab("Identified breakpoint location")+ylab("True breakpoint location")+theme(axis.title.x = element_text(size = 20), axis.title.y = element_text(size = 20))+scale_x_continuous(expand = c(0, 0),breaks=seq(0,200,by=50),limits=c(0,200))+scale_fill_continuous(type = "viridis")
#ggarrange(density_2d_rec, density_rec, ncol = 2, labels = c("A", "B"))+scale_y_continuous(expand = c(0, 0))
dev.off()
```

